/*! Riloadr.js 1.4.3 (c) 2013 Tubal Martin - MIT license */
!function(definition){if(typeof define==="function"&&define.amd)define(definition);else window.Riloadr=definition()}(function(){var ON="on",TOP="top",SRC="src",TRUE=!0,BODY="body",LEFT="left",FALSE=!1,DELAY=250,NULL=null,LOAD="load",CALL="call",APPLY="apply",ERROR="error",WIDTH="width",EMPTYSTRING="",HEIGHT="height",LENGTH="length",SCROLL="scroll",OFFSET="offset",CLIENT="client",RESIZE="resize",ONLOAD=ON+LOAD,ONERROR=ON+ERROR,ONABORT=ON+"abort",RETRIES="retries",MINWIDTH="minWidth",MAXWIDTH="maxWidth",
COMPLETE="complete",RILOADED="riloaded",FALLBACK="fallback",CLASSNAME="className",IMGFORMAT="imgFormat",PROTOTYPE="prototype",UNDEFINED="undefined",SCROLLTOP=SCROLL+"Top",ONCOMPLETE=ON+COMPLETE,READYSTATE="readyState",SCROLLLEFT=SCROLL+"Left",LOADIMAGES=LOAD+"Images",PAGEYOFFSET="pageYOffset",PAGEXOFFSET="pageXOffset",ORIENTATION="orientation",ATTACHEVENT="attachEvent",EVENTLISTENER="EventListener",GETELEMENTBYID="getElementById",DOCUMENTELEMENT="documentElement",READYSTATECHANGE="readystatechange",
QUERYSELECTORALL="querySelectorAll",ADDEVENTLISTENER="add"+EVENTLISTENER,ORIENTATIONCHANGE=ORIENTATION+"change",MINDEVICEPIXELRATIO="minDevicePixelRatio",GETBOUNDINGCLIENTRECT="getBoundingClientRect",body,win=window,doc=win.document,docElm=doc[DOCUMENTELEMENT],w3c=ADDEVENTLISTENER in doc,pre=w3c?EMPTYSTRING:ON,add=w3c?ADDEVENTLISTENER:ATTACHEVENT,rem=w3c?"remove"+EVENTLISTENER:"detachEvent",QUESTION_MARK_REGEX=/\?/,BREAKPOINT_NAME_REGEX=/{breakpoint-name}/gi,selectorsApiSupported=QUERYSELECTORALL in
doc,orientationSupported=ORIENTATION in win&&ON+ORIENTATIONCHANGE in win,viewportWidth,screenWidth=win.screen[WIDTH],devicePixelRatio=win.devicePixelRatio||1,hasLowBandwidth=hasLowBandwidth(),operaMini=Object[PROTOTYPE].toString[CALL](win.operamini)==="[object OperaMini]",onDomReady,lastOrientation;docElm[CLASSNAME]=docElm[CLASSNAME].replace(/(^|\s)no-js(\s|$)/,"$1$2");function Riloadr(options){var instance=this,base=options.base||EMPTYSTRING,useDataBreak=options.useDataBreak||false,breakpoints=options.breakpoints||
error('"breakpoints" not defined.'),className=options.name||"responsive",classNameRegexp=new RegExp("(^|\\s)"+className+"(\\s|$)"),deferObj=options.defer&&(typeof options.defer=="string"?{"mode":options.defer,"threshold":options.foldDistance,"overflownElemsIds":[]}:options.defer),deferMode=deferObj&&deferObj.mode.toLowerCase(),threshold=deferObj&&deferObj.threshold||100,overflownElemsIds=deferObj&&deferObj.overflownElemsIds,watchViewportMode=options.watchViewportWidth,watchViewportEnabled=!!watchViewportMode,
watchViewportUp=watchViewportMode=="wider",watchViewportBoth=watchViewportMode=="*",ignoreLowBandwidth=options.ignoreLowBandwidth||FALSE,retries=options[RETRIES]||0,root=options.root||NULL,deferInvisibleEnabled=(deferMode=="invisible"||deferMode=="belowfold")&&!operaMini,scrollListener=throttle(function(){instance[LOADIMAGES]()},DELAY),resizeListener=debounce(function(){watchViewportEnabled&&setVwidthAndBreakpoints();instance[LOADIMAGES](watchViewportEnabled)},DELAY),orientationchangeListener=debounce(function(){if(win[ORIENTATION]!==
lastOrientation){lastOrientation=win[ORIENTATION];instance[LOADIMAGES]()}},DELAY),images=[],imagesPendingLoad=0,breakpoint,prevBreakpoint,fallbackBreakpoint={},widestBreakpoint,currentBreakpointIsWidest;function setVwidthAndBreakpoints(){viewportWidth=getViewportWidthInCssPixels();breakpoint=getBreakpoint(breakpoints,viewportWidth,ignoreLowBandwidth);fallbackBreakpoint=breakpoint[FALLBACK]&&getFallbackBreakpoint(breakpoints,breakpoint[FALLBACK]);widestBreakpoint=widestBreakpoint||watchViewportEnabled&&
getWidestBreakpoint(breakpoints);currentBreakpointIsWidest=watchViewportUp&&areBreakpointsEqual(breakpoint,widestBreakpoint)}function addEventListeners(){var i=0,current;if(deferInvisibleEnabled||watchViewportEnabled)addEvent(win,RESIZE,resizeListener);if(deferInvisibleEnabled){addEvent(win,SCROLL,scrollListener);if(orientationSupported){lastOrientation=win[ORIENTATION];addEvent(win,ORIENTATIONCHANGE,orientationchangeListener)}if(overflownElemsIds)while(current=overflownElemsIds[i]){addEvent(doc[GETELEMENTBYID](current),
SCROLL,scrollListener);i++}}}function removeEventListeners(){var i=0,current;if(!watchViewportEnabled){removeEvent(win,RESIZE,resizeListener);if(deferInvisibleEnabled){removeEvent(win,SCROLL,scrollListener);if(overflownElemsIds)while(current=overflownElemsIds[i]){removeEvent(doc[GETELEMENTBYID](current),SCROLL,scrollListener);i++}orientationSupported&&removeEvent(win,ORIENTATIONCHANGE,orientationchangeListener)}}}function loadImage(img,idx){img[RETRIES]=0;img[FALLBACK]=FALSE;img[ONLOAD]=imageOnloadCallback;
img[ONERROR]=img[ONABORT]=imageOnerrorCallback;img[SRC]=getImageSrc(img,base,breakpoint,useDataBreak);images.splice(idx,1)}function imageOnloadCallback(){var img=this,_img,dim;if("naturalWidth"in img)dim=img["naturalWidth"]+img["naturalHeight"];else{_img=new Image;_img[SRC]=img[SRC];dim=_img[WIDTH]+_img[HEIGHT];_img=NULL}if(+dim>0){img[ONLOAD]=img[ONERROR]=img[ONABORT]=NULL;img[RILOADED]&&(img[CLASSNAME]=img[CLASSNAME].replace(classNameRegexp,"$1$2"));deferInvisibleEnabled&&(img.style.visibility=
"visible");ONLOAD in options&&options[ONLOAD][CALL](img);onCompleteCallback()}}function imageOnerrorCallback(){var img=this,loadImage=function(src){var _img=new Image;_img[ONLOAD]=function(){img[SRC]=_img[SRC];imageOnloadCallback[CALL](img)};_img[ONERROR]=img[ONABORT]=function(){imageOnerrorCallback[CALL](img)};_img[SRC]=src},src;img[ONLOAD]=img[ONERROR]=img[ONABORT]=NULL;ONERROR in options&&options[ONERROR][CALL](img);if(img[RETRIES]<retries){img[RETRIES]++;src=getImageSrc(img,base,img[FALLBACK]?
fallbackBreakpoint:breakpoint,useDataBreak,TRUE);loadImage(src)}else if(FALLBACK in breakpoint&&!img[FALLBACK]){img[RETRIES]=0;img[FALLBACK]=TRUE;src=getImageSrc(img,base,fallbackBreakpoint,useDataBreak);loadImage(src)}else onCompleteCallback()}function onCompleteCallback(){imagesPendingLoad--;if(imagesPendingLoad===0){removeEventListeners();ONCOMPLETE in options&&options[ONCOMPLETE]()}}instance[LOADIMAGES]=function(update){defer(function(imageList,current,i){if(!images[LENGTH]||update===TRUE){update&&
addEventListeners();imageList=selectorsApiSupported&&root[QUERYSELECTORALL]("img."+className)||root.getElementsByTagName("img");i=0;while(current=imageList[i]){if(current&&(!current[RILOADED]&&(selectorsApiSupported||current[CLASSNAME].indexOf(className)>=0))){if(!watchViewportEnabled||watchViewportEnabled&&(!prevBreakpoint||(watchViewportUp&&isBreakpointWider(breakpoint,prevBreakpoint)||watchViewportBoth&&!areBreakpointsEqual(breakpoint,prevBreakpoint)))){images.push(current);imagesPendingLoad++}if(!watchViewportEnabled||
currentBreakpointIsWidest)current[RILOADED]=TRUE}i++}if(watchViewportEnabled){if(currentBreakpointIsWidest)watchViewportEnabled=FALSE;prevBreakpoint=breakpoint}}if(images[LENGTH]){i=0;while(current=images[i]){if(current&&(!deferInvisibleEnabled||deferInvisibleEnabled&&isInViewport(current,threshold))){loadImage(current,i);i--}i++}}imageList=current=NULL})};onDomReady(function(){body=doc[BODY];root=doc[GETELEMENTBYID](root)||body;setVwidthAndBreakpoints();addEventListeners();if(!deferMode||deferInvisibleEnabled)instance[LOADIMAGES]();
else onWindowReady(instance[LOADIMAGES])})}Riloadr.version="1.4.3";Riloadr[PROTOTYPE].riload=function(){this[LOADIMAGES](TRUE)};function getBreakpoint(breakpoints,vWidth,ignoreLowBandwidth){var _vWidth=vWidth,i=0,breakpoint={},_breakpoint,minWidth,maxWidth,minDpr;while(_breakpoint=breakpoints[i]){minWidth=_breakpoint[MINWIDTH];maxWidth=_breakpoint[MAXWIDTH];minDpr=_breakpoint[MINDEVICEPIXELRATIO];if(vWidth>0){if(minWidth&&(maxWidth&&(vWidth>=minWidth&&vWidth<=maxWidth))||(minWidth&&(!maxWidth&&vWidth>=
minWidth)||maxWidth&&(!minWidth&&vWidth<=maxWidth)))if(!minDpr||minDpr&&(devicePixelRatio>=minDpr&&(ignoreLowBandwidth||!ignoreLowBandwidth&&!hasLowBandwidth)))breakpoint=_breakpoint}else if(_vWidth<=0||(minWidth<_vWidth||maxWidth<_vWidth)){_vWidth=minWidth||(maxWidth||_vWidth);breakpoint=_breakpoint}i++}return breakpoint}function getWidestBreakpoint(breakpoints){var i=0,widestBreakpoint={},current;while(current=breakpoints[i]){isBreakpointWider(current,widestBreakpoint)&&(widestBreakpoint=current);
i++}return widestBreakpoint}function getFallbackBreakpoint(breakpoints,fallbackBreakpointName){var i=0,current;while(current=breakpoints[i]){if(current.name==fallbackBreakpointName)return current;i++}}function areBreakpointsEqual(a,b){return a.name===b.name&&(a[MINWIDTH]===b[MINWIDTH]&&(a[MAXWIDTH]===b[MAXWIDTH]&&(a[MINDEVICEPIXELRATIO]===b[MINDEVICEPIXELRATIO]&&a[IMGFORMAT]===b[IMGFORMAT])))}function isBreakpointWider(a,b){var aMinDpr=+a[MINDEVICEPIXELRATIO]||1,bMinDpr=+b[MINDEVICEPIXELRATIO]||1;
a=Math.max(+a[MINWIDTH]||0,+a[MAXWIDTH]||0)*(devicePixelRatio>=aMinDpr?aMinDpr:1);b=Math.max(+b[MINWIDTH]||0,+b[MAXWIDTH]||0)*(devicePixelRatio>=bMinDpr?bMinDpr:1);return a>b}function getViewportWidthInCssPixels(){var math=Math,widths=[docElm.clientWidth,docElm.offsetWidth,body.clientWidth],screenWidthFallback=math.ceil(screenWidth/devicePixelRatio),l=widths[LENGTH],i=0,width;for(;i<l;i++)if(isNaN(widths[i])){widths.splice(i,1);i--}if(widths[LENGTH]){width=math.max[APPLY](math,widths);if(!isNaN(screenWidthFallback))width=
math.min(screenWidthFallback,width)}return width||(screenWidthFallback||0)}function getImageSrc(img,base,breakpoint,useDataBreak,reload){var src;if(useDataBreak){console.log();src=(img.getAttribute("data-base")||base)+(img.getAttribute("data-src-"+breakpoint.name)||EMPTYSTRING)}else src=(img.getAttribute("data-base")||base)+(img.getAttribute("data-src")||EMPTYSTRING);if(breakpoint[IMGFORMAT]){src=src.split(".");src.pop();src=src.join(".")+"."+breakpoint[IMGFORMAT]}if(reload)src+=(QUESTION_MARK_REGEX.test(src)?
"&":"?")+"riloadrts="+(new Date).getTime();return src.replace(BREAKPOINT_NAME_REGEX,breakpoint.name)}function hasLowBandwidth(){var navigator=win.navigator,connection=navigator.connection||(navigator.mozConnection||(navigator.webkitConnection||(navigator.oConnection||(navigator.msConnection||{})))),type=connection.type||"unknown",bandwidth=+connection.bandwidth||Infinity;return bandwidth>0&&bandwidth<0.1||/^[23]g|3|4$/.test(type+EMPTYSTRING)}function isInViewport(img,threshold){return!isBelowTheFold(img,
threshold)&&(!isAboveTheTop(img,threshold)&&(!isRightOfFold(img,threshold)&&!isLeftOfBegin(img,threshold)))}function isBelowTheFold(img,threshold){return getDimension(HEIGHT,win)+getScroll(TOP,win)<=getOffset(TOP,img)-threshold}function isAboveTheTop(img,threshold){return getScroll(TOP,win)>=getOffset(TOP,img)+threshold+getDimension(HEIGHT,img)}function isRightOfFold(img,threshold){return getDimension(WIDTH,win)+getScroll(LEFT,win)<=getOffset(LEFT,img)-threshold}function isLeftOfBegin(img,threshold){return getScroll(LEFT,
win)>=getOffset(LEFT,img)+threshold+getDimension(WIDTH,img)}function getOffset(name,elem){var box={top:0,left:0},doc=elem&&elem.ownerDocument,win,offsets;if(!doc)return;if(typeof elem[GETBOUNDINGCLIENTRECT]!==UNDEFINED)box=elem[GETBOUNDINGCLIENTRECT]();win=getWindow(doc);offsets={top:box[TOP]+(win[PAGEYOFFSET]||docElm[SCROLLTOP])-(docElm.clientTop||0),left:box[LEFT]+(win[PAGEXOFFSET]||docElm[SCROLLLEFT])-(docElm.clientLeft||0)};return offsets[name]}function getScroll(name,elem){var names={top:{method:SCROLLTOP,
prop:PAGEYOFFSET},left:{method:SCROLLLEFT,prop:PAGEXOFFSET}},method=names[name].method,prop=names[name].prop,win=getWindow(elem);return win?prop in win?win[prop]:docElm[method]:elem[method]}function getDimension(name,elem){var names={height:"Height",width:"Width"},doc,val,styles;name=names[name];if(isWindow(elem))return docElm[CLIENT+name];val=elem[OFFSET+name];name=name.toLowerCase();if(val<=0||val==NULL){if(win.getComputedStyle)styles=win.getComputedStyle(elem,NULL);else if(docElm.currentStyle)styles=
elem.currentStyle;if(styles)val=styles[name];if(val<0||val==NULL)val=elem.style[name]}return parseFloat(val)||0}function isWindow(obj){return obj!=NULL&&obj==obj.window}function getWindow(elem){return isWindow(elem)?elem:elem.nodeType===9?elem.defaultView||elem.parentWindow:FALSE}function throttle(func,wait){var args,result,thisArg,timeoutId,lastCalled=0;function trailingCall(){lastCalled=new Date;timeoutId=NULL;func[APPLY](thisArg,args)}return function(){var now=new Date,remain=wait-(now-lastCalled);
args=arguments;thisArg=this;if(remain<=0){lastCalled=now;result=func[APPLY](thisArg,args)}else if(!timeoutId)timeoutId=delay(trailingCall,remain);return result}}function debounce(func,wait,immediate){var args,result,thisArg,timeoutId;function delayed(){timeoutId=NULL;if(!immediate)func[APPLY](thisArg,args)}return function(){var isImmediate=immediate&&!timeoutId;args=arguments;thisArg=this;clearTimeout(timeoutId);timeoutId=delay(delayed,wait);if(isImmediate)result=func[APPLY](thisArg,args);return result}}
function delay(func,wait){var args=Array[PROTOTYPE].slice[CALL](arguments,2);return win.setTimeout(function(){return func[APPLY](NULL,args)},wait)}function defer(func){return delay[APPLY](NULL,[func,1].concat(Array[PROTOTYPE].slice[CALL](arguments,1)))}function error(msg){throw new Error("Riloadr: "+msg);}function addEvent(elem,type,fn){elem[add](pre+type,fn,FALSE)}function removeEvent(elem,type,fn){elem[rem](pre+type,fn,FALSE)}onDomReady=function(){var DOMCONTENTLOADED="DOMContentLoaded",top=FALSE,
isReady=FALSE,callbacks=[];function ready(fn){if(!isReady){if(!doc[BODY])return defer(ready);isReady=TRUE;while(fn=callbacks.shift())defer(fn)}}function completed(event){if(w3c||(event.type===LOAD||doc[READYSTATE]===COMPLETE)){detach();ready()}}function detach(){removeEvent(doc,w3c?DOMCONTENTLOADED:READYSTATECHANGE,completed);removeEvent(win,LOAD,completed)}if(doc[READYSTATE]===COMPLETE)defer(ready);else{if(w3c)addEvent(doc,DOMCONTENTLOADED,completed);else{addEvent(doc,READYSTATECHANGE,completed);
try{top=win.frameElement==NULL&&docElem}catch(e){}if(top&&top.doScroll)(function doScrollCheck(){if(!isReady){try{top.doScroll("left")}catch(e){return delay(doScrollCheck,50)}detach();ready()}})()}addEvent(win,LOAD,completed)}return function(fn){isReady?defer(fn):callbacks.push(fn)}}();function onWindowReady(fn){if(doc[READYSTATE]===COMPLETE)defer(fn);else{var _fn=function(){removeEvent(win,LOAD,_fn);defer(fn)};addEvent(win,LOAD,_fn)}}return Riloadr});